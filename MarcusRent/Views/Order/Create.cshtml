@model MarcusRent.Models.OrderViewModel

@{
    decimal pricePerDay = ViewBag.PricePerDay ?? 0m;
}

<h2>Boka bil</h2>

<p>Bokar bil: @ViewBag.CarInfo</p>

<form asp-action="Create" method="post">
    <input type="hidden" asp-for="CarId" />

    <div class="form-group">
        <label asp-for="StartDate"></label>
        <input asp-for="StartDate" class="form-control" />
        <span asp-validation-for="StartDate" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="EndDate"></label>
        <input asp-for="EndDate" class="form-control" />
        <span asp-validation-for="EndDate" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary">Boka</button>
</form>

<script>
    const startDateInput = document.getElementById('startDate');
    const endDateInput = document.getElementById('endDate');
    const priceInput = document.getElementById('price');
    const pricePerDay = @pricePerDay;

    function calculatePrice() {
        const startDate = new Date(startDateInput.value);
        const endDate = new Date(endDateInput.value);

        if (startDate && endDate && endDate > startDate) {
            const diffTime = endDate - startDate;
            const diffDays = diffTime / (1000 * 60 * 60 * 24);
            const totalPrice = diffDays * pricePerDay;
            priceInput.value = totalPrice.toFixed(2) + " kr";
        } else {
            priceInput.value = "";
        }
    }

    startDateInput.addEventListener('change', calculatePrice);
    endDateInput.addEventListener('change', calculatePrice);

    // Kör beräkning när sidan laddas
    calculatePrice();
</script>